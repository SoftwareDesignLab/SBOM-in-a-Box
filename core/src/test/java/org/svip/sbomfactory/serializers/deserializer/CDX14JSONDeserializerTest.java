package org.svip.sbomfactory.serializers.deserializer;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.json.JsonMapper;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.params.provider.ValueSource;
import org.svip.sbom.model.interfaces.generics.SBOM;
import org.svip.sbom.model.objects.CycloneDX14.CDX14SBOM;
import org.svip.sbomfactory.translators.TranslatorException;

import static org.junit.jupiter.api.Assertions.*;
import static org.svip.sbomfactory.translators.Utils.checkForAppTools;

public class CDX14JSONDeserializerTest extends DeserializerTest {
    public CDX14JSONDeserializerTest() {
        super(new CDX14JSONDeserializer());
    }

    public static final String TEST_SMALL_CDX_JSON = "{ \"bomFormat\": \"CycloneDX\", \"specVersion\": \"1.4\", \"serialNumber\": \"urn:uuid:139f2560-6fb3-4b85-b5fc-fe48be29b72b\", \"version\": 1, \"metadata\": { \"timestamp\": \"2023-04-05T07:56:11-04:00\", \"tools\": [ { \"vendor\": \"anchore\", \"name\": \"syft\", \"version\": \"0.69.1\" } ], \"component\": { \"bom-ref\": \"c4a58a4c9826996e\", \"type\": \"container\", \"name\": \"alpine:latest\", \"version\": \"sha256:b6ca290b6b4cdcca5b3db3ffa338ee0285c11744b4a6abaa9627746ee3291d8d\" } }, \"components\": [ { \"bom-ref\": \"pkg:apk/alpine/alpine-baselayout@3.4.0-r0?arch=x86_64&upstream=alpine-baselayout&distro=alpine-3.17.3&package-id=92b19c7750fb559d\", \"type\": \"library\", \"publisher\": \"Natanael Copa <ncopa@alpinelinux.org>\", \"name\": \"alpine-baselayout\", \"version\": \"3.4.0-r0\", \"description\": \"Alpine base dir structure and init scripts\", \"licenses\": [ { \"license\": { \"id\": \"GPL-2.0-only\" } } ], \"cpe\": \"cpe:2.3:a:alpine-baselayout:alpine-baselayout:3.4.0-r0:*:*:*:*:*:*:*\", \"purl\": \"pkg:apk/alpine/alpine-baselayout@3.4.0-r0?arch=x86_64&upstream=alpine-baselayout&distro=alpine-3.17.3\", \"externalReferences\": [ { \"url\": \"https://git.alpinelinux.org/cgit/aports/tree/main/alpine-baselayout\", \"type\": \"distribution\" } ], \"properties\": [ { \"name\": \"syft:package:foundBy\", \"value\": \"apkdb-cataloger\" }, { \"name\": \"syft:package:metadataType\", \"value\": \"ApkMetadata\" }, { \"name\": \"syft:package:type\", \"value\": \"apk\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine-baselayout:alpine_baselayout:3.4.0-r0:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine_baselayout:alpine-baselayout:3.4.0-r0:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine_baselayout:alpine_baselayout:3.4.0-r0:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine:alpine-baselayout:3.4.0-r0:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine:alpine_baselayout:3.4.0-r0:*:*:*:*:*:*:*\" }, { \"name\": \"syft:location:0:layerID\", \"value\": \"sha256:f1417ff83b319fbdae6dd9cd6d8c9c88002dcd75ecf6ec201c8c6894681cf2b5\" }, { \"name\": \"syft:location:0:path\", \"value\": \"/lib/apk/db/installed\" }, { \"name\": \"syft:metadata:gitCommitOfApkPort\", \"value\": \"bd965a7ebf7fd8f07d7a0cc0d7375bf3e4eb9b24\" }, { \"name\": \"syft:metadata:installedSize\", \"value\": \"331776\" }, { \"name\": \"syft:metadata:originPackage\", \"value\": \"alpine-baselayout\" }, { \"name\": \"syft:metadata:pullChecksum\", \"value\": \"Q1/eXfmbYT1WXenFSqKjroYyK84NE=\" }, { \"name\": \"syft:metadata:pullDependencies:0\", \"value\": \"alpine-baselayout-data=3.4.0-r0\" }, { \"name\": \"syft:metadata:pullDependencies:1\", \"value\": \"/bin/sh\" }, { \"name\": \"syft:metadata:size\", \"value\": \"8890\" } ] }, { \"bom-ref\": \"pkg:apk/alpine/alpine-baselayout-data@3.4.0-r0?arch=x86_64&upstream=alpine-baselayout&distro=alpine-3.17.3&package-id=291d1267b40d636f\", \"type\": \"library\", \"publisher\": \"Natanael Copa <ncopa@alpinelinux.org>\", \"name\": \"alpine-baselayout-data\", \"version\": \"3.4.0-r0\", \"description\": \"Alpine base dir structure and init scripts\", \"licenses\": [ { \"license\": { \"id\": \"GPL-2.0-only\" } } ], \"cpe\": \"cpe:2.3:a:alpine-baselayout-data:alpine-baselayout-data:3.4.0-r0:*:*:*:*:*:*:*\", \"purl\": \"pkg:apk/alpine/alpine-baselayout-data@3.4.0-r0?arch=x86_64&upstream=alpine-baselayout&distro=alpine-3.17.3\", \"externalReferences\": [ { \"url\": \"https://git.alpinelinux.org/cgit/aports/tree/main/alpine-baselayout\", \"type\": \"distribution\" } ], \"properties\": [ { \"name\": \"syft:package:foundBy\", \"value\": \"apkdb-cataloger\" }, { \"name\": \"syft:package:metadataType\", \"value\": \"ApkMetadata\" }, { \"name\": \"syft:package:type\", \"value\": \"apk\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine-baselayout-data:alpine_baselayout_data:3.4.0-r0:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine_baselayout_data:alpine-baselayout-data:3.4.0-r0:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine_baselayout_data:alpine_baselayout_data:3.4.0-r0:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine-baselayout:alpine-baselayout-data:3.4.0-r0:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine-baselayout:alpine_baselayout_data:3.4.0-r0:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine_baselayout:alpine-baselayout-data:3.4.0-r0:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine_baselayout:alpine_baselayout_data:3.4.0-r0:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine:alpine-baselayout-data:3.4.0-r0:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine:alpine_baselayout_data:3.4.0-r0:*:*:*:*:*:*:*\" }, { \"name\": \"syft:location:0:layerID\", \"value\": \"sha256:f1417ff83b319fbdae6dd9cd6d8c9c88002dcd75ecf6ec201c8c6894681cf2b5\" }, { \"name\": \"syft:location:0:path\", \"value\": \"/lib/apk/db/installed\" }, { \"name\": \"syft:metadata:gitCommitOfApkPort\", \"value\": \"bd965a7ebf7fd8f07d7a0cc0d7375bf3e4eb9b24\" }, { \"name\": \"syft:metadata:installedSize\", \"value\": \"77824\" }, { \"name\": \"syft:metadata:originPackage\", \"value\": \"alpine-baselayout\" }, { \"name\": \"syft:metadata:pullChecksum\", \"value\": \"Q1/JgpM8J6DWI/541tUX+uHEzSjqo=\" }, { \"name\": \"syft:metadata:size\", \"value\": \"11664\" } ] }, { \"bom-ref\": \"pkg:apk/alpine/alpine-keys@2.4-r1?arch=x86_64&upstream=alpine-keys&distro=alpine-3.17.3&package-id=2b5e23d349b556cf\", \"type\": \"library\", \"publisher\": \"Natanael Copa <ncopa@alpinelinux.org>\", \"name\": \"alpine-keys\", \"version\": \"2.4-r1\", \"description\": \"Public keys for Alpine Linux packages\", \"licenses\": [ { \"license\": { \"id\": \"MIT\" } } ], \"cpe\": \"cpe:2.3:a:alpine-keys:alpine-keys:2.4-r1:*:*:*:*:*:*:*\", \"purl\": \"pkg:apk/alpine/alpine-keys@2.4-r1?arch=x86_64&upstream=alpine-keys&distro=alpine-3.17.3\", \"externalReferences\": [ { \"url\": \"https://alpinelinux.org\", \"type\": \"distribution\" } ], \"properties\": [ { \"name\": \"syft:package:foundBy\", \"value\": \"apkdb-cataloger\" }, { \"name\": \"syft:package:metadataType\", \"value\": \"ApkMetadata\" }, { \"name\": \"syft:package:type\", \"value\": \"apk\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine-keys:alpine_keys:2.4-r1:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine_keys:alpine-keys:2.4-r1:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine_keys:alpine_keys:2.4-r1:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine:alpine-keys:2.4-r1:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:alpine:alpine_keys:2.4-r1:*:*:*:*:*:*:*\" }, { \"name\": \"syft:location:0:layerID\", \"value\": \"sha256:f1417ff83b319fbdae6dd9cd6d8c9c88002dcd75ecf6ec201c8c6894681cf2b5\" }, { \"name\": \"syft:location:0:path\", \"value\": \"/lib/apk/db/installed\" }, { \"name\": \"syft:metadata:gitCommitOfApkPort\", \"value\": \"aab68f8c9ab434a46710de8e12fb3206e2930a59\" }, { \"name\": \"syft:metadata:installedSize\", \"value\": \"159744\" }, { \"name\": \"syft:metadata:originPackage\", \"value\": \"alpine-keys\" }, { \"name\": \"syft:metadata:pullChecksum\", \"value\": \"Q1KM01lfKVp+gEZn23awujqjSkrN8=\" }, { \"name\": \"syft:metadata:size\", \"value\": \"13361\" } ] }, { \"bom-ref\": \"pkg:apk/alpine/apk-tools@2.12.10-r1?arch=x86_64&upstream=apk-tools&distro=alpine-3.17.3&package-id=e5f757b0df1f62bc\", \"type\": \"library\", \"publisher\": \"Natanael Copa <ncopa@alpinelinux.org>\", \"name\": \"apk-tools\", \"version\": \"2.12.10-r1\", \"description\": \"Alpine Package Keeper - package manager for alpine\", \"licenses\": [ { \"license\": { \"id\": \"GPL-2.0-only\" } } ], \"cpe\": \"cpe:2.3:a:apk-tools:apk-tools:2.12.10-r1:*:*:*:*:*:*:*\", \"purl\": \"pkg:apk/alpine/apk-tools@2.12.10-r1?arch=x86_64&upstream=apk-tools&distro=alpine-3.17.3\", \"externalReferences\": [ { \"url\": \"https://gitlab.alpinelinux.org/alpine/apk-tools\", \"type\": \"distribution\" } ], \"properties\": [ { \"name\": \"syft:package:foundBy\", \"value\": \"apkdb-cataloger\" }, { \"name\": \"syft:package:metadataType\", \"value\": \"ApkMetadata\" }, { \"name\": \"syft:package:type\", \"value\": \"apk\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:apk-tools:apk_tools:2.12.10-r1:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:apk_tools:apk-tools:2.12.10-r1:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:apk_tools:apk_tools:2.12.10-r1:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:apk:apk-tools:2.12.10-r1:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:apk:apk_tools:2.12.10-r1:*:*:*:*:*:*:*\" }, { \"name\": \"syft:location:0:layerID\", \"value\": \"sha256:f1417ff83b319fbdae6dd9cd6d8c9c88002dcd75ecf6ec201c8c6894681cf2b5\" }, { \"name\": \"syft:location:0:path\", \"value\": \"/lib/apk/db/installed\" }, { \"name\": \"syft:metadata:gitCommitOfApkPort\", \"value\": \"0188f510baadbae393472103427b9c1875117136\" }, { \"name\": \"syft:metadata:installedSize\", \"value\": \"307200\" }, { \"name\": \"syft:metadata:originPackage\", \"value\": \"apk-tools\" }, { \"name\": \"syft:metadata:provides:0\", \"value\": \"so:libapk.so.3.12.0=3.12.0\" }, { \"name\": \"syft:metadata:provides:1\", \"value\": \"cmd:apk=2.12.10-r1\" }, { \"name\": \"syft:metadata:pullChecksum\", \"value\": \"Q1Ef3iwt+cMdGngEgaFr2URIJhKzQ=\" }, { \"name\": \"syft:metadata:pullDependencies:0\", \"value\": \"musl>=1.2\" }, { \"name\": \"syft:metadata:pullDependencies:1\", \"value\": \"ca-certificates-bundle\" }, { \"name\": \"syft:metadata:pullDependencies:2\", \"value\": \"so:libc.musl-x86_64.so.1\" }, { \"name\": \"syft:metadata:pullDependencies:3\", \"value\": \"so:libcrypto.so.3\" }, { \"name\": \"syft:metadata:pullDependencies:4\", \"value\": \"so:libssl.so.3\" }, { \"name\": \"syft:metadata:pullDependencies:5\", \"value\": \"so:libz.so.1\" }, { \"name\": \"syft:metadata:size\", \"value\": \"120973\" } ] }, { \"bom-ref\": \"d49bb0510b7c7ca7\", \"type\": \"application\", \"name\": \"busybox\", \"version\": \"1.35.0\", \"cpe\": \"cpe:2.3:a:busybox:busybox:1.35.0:*:*:*:*:*:*:*\", \"properties\": [ { \"name\": \"syft:package:foundBy\", \"value\": \"binary-cataloger\" }, { \"name\": \"syft:package:metadataType\", \"value\": \"BinaryMetadata\" }, { \"name\": \"syft:package:type\", \"value\": \"binary\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:busybox:busybox:1.35.0:*:*:*:*:*:*:*\" }, { \"name\": \"syft:location:0:layerID\", \"value\": \"sha256:f1417ff83b319fbdae6dd9cd6d8c9c88002dcd75ecf6ec201c8c6894681cf2b5\" }, { \"name\": \"syft:location:0:path\", \"value\": \"/bin/busybox\" } ] }, { \"bom-ref\": \"pkg:apk/alpine/busybox@1.35.0-r29?arch=x86_64&upstream=busybox&distro=alpine-3.17.3&package-id=623d53216342d45e\", \"type\": \"library\", \"publisher\": \"Sören Tempel <soeren+alpine@soeren-tempel.net>\", \"name\": \"busybox\", \"version\": \"1.35.0-r29\", \"description\": \"Size optimized toolbox of many common UNIX utilities\", \"licenses\": [ { \"license\": { \"id\": \"GPL-2.0-only\" } } ], \"cpe\": \"cpe:2.3:a:busybox:busybox:1.35.0-r29:*:*:*:*:*:*:*\", \"purl\": \"pkg:apk/alpine/busybox@1.35.0-r29?arch=x86_64&upstream=busybox&distro=alpine-3.17.3\", \"externalReferences\": [ { \"url\": \"https://busybox.net/\", \"type\": \"distribution\" } ], \"properties\": [ { \"name\": \"syft:package:foundBy\", \"value\": \"apkdb-cataloger\" }, { \"name\": \"syft:package:metadataType\", \"value\": \"ApkMetadata\" }, { \"name\": \"syft:package:type\", \"value\": \"apk\" }, { \"name\": \"syft:location:0:layerID\", \"value\": \"sha256:f1417ff83b319fbdae6dd9cd6d8c9c88002dcd75ecf6ec201c8c6894681cf2b5\" }, { \"name\": \"syft:location:0:path\", \"value\": \"/lib/apk/db/installed\" }, { \"name\": \"syft:metadata:gitCommitOfApkPort\", \"value\": \"1dbf7a793afae640ea643a055b6dd4f430ac116b\" }, { \"name\": \"syft:metadata:installedSize\", \"value\": \"962560\" }, { \"name\": \"syft:metadata:originPackage\", \"value\": \"busybox\" }, { \"name\": \"syft:metadata:provides:0\", \"value\": \"cmd:busybox=1.35.0-r29\" }, { \"name\": \"syft:metadata:pullChecksum\", \"value\": \"Q1NN3sp0yr99btRysqty3nQUrWHaY=\" }, { \"name\": \"syft:metadata:pullDependencies:0\", \"value\": \"so:libc.musl-x86_64.so.1\" }, { \"name\": \"syft:metadata:size\", \"value\": \"509600\" } ] }, { \"bom-ref\": \"pkg:apk/alpine/busybox-binsh@1.35.0-r29?arch=x86_64&upstream=busybox&distro=alpine-3.17.3&package-id=256fc96b4a8c4da8\", \"type\": \"library\", \"publisher\": \"Sören Tempel <soeren+alpine@soeren-tempel.net>\", \"name\": \"busybox-binsh\", \"version\": \"1.35.0-r29\", \"description\": \"busybox ash /bin/sh\", \"licenses\": [ { \"license\": { \"id\": \"GPL-2.0-only\" } } ], \"cpe\": \"cpe:2.3:a:busybox-binsh:busybox-binsh:1.35.0-r29:*:*:*:*:*:*:*\", \"purl\": \"pkg:apk/alpine/busybox-binsh@1.35.0-r29?arch=x86_64&upstream=busybox&distro=alpine-3.17.3\", \"externalReferences\": [ { \"url\": \"https://busybox.net/\", \"type\": \"distribution\" } ], \"properties\": [ { \"name\": \"syft:package:foundBy\", \"value\": \"apkdb-cataloger\" }, { \"name\": \"syft:package:metadataType\", \"value\": \"ApkMetadata\" }, { \"name\": \"syft:package:type\", \"value\": \"apk\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:busybox-binsh:busybox_binsh:1.35.0-r29:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:busybox_binsh:busybox-binsh:1.35.0-r29:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:busybox_binsh:busybox_binsh:1.35.0-r29:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:busybox:busybox-binsh:1.35.0-r29:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:busybox:busybox_binsh:1.35.0-r29:*:*:*:*:*:*:*\" }, { \"name\": \"syft:location:0:layerID\", \"value\": \"sha256:f1417ff83b319fbdae6dd9cd6d8c9c88002dcd75ecf6ec201c8c6894681cf2b5\" }, { \"name\": \"syft:location:0:path\", \"value\": \"/lib/apk/db/installed\" }, { \"name\": \"syft:metadata:gitCommitOfApkPort\", \"value\": \"1dbf7a793afae640ea643a055b6dd4f430ac116b\" }, { \"name\": \"syft:metadata:installedSize\", \"value\": \"8192\" }, { \"name\": \"syft:metadata:originPackage\", \"value\": \"busybox\" }, { \"name\": \"syft:metadata:provides:0\", \"value\": \"/bin/sh\" }, { \"name\": \"syft:metadata:provides:1\", \"value\": \"cmd:sh=1.35.0-r29\" }, { \"name\": \"syft:metadata:pullChecksum\", \"value\": \"Q1miWwyhWKXVEiRYLhmArV1TKMs6A=\" }, { \"name\": \"syft:metadata:pullDependencies:0\", \"value\": \"busybox=1.35.0-r29\" }, { \"name\": \"syft:metadata:size\", \"value\": \"1547\" } ] }, { \"bom-ref\": \"pkg:apk/alpine/ca-certificates-bundle@20220614-r4?arch=x86_64&upstream=ca-certificates&distro=alpine-3.17.3&package-id=b805d823ae624f04\", \"type\": \"library\", \"publisher\": \"Natanael Copa <ncopa@alpinelinux.org>\", \"name\": \"ca-certificates-bundle\", \"version\": \"20220614-r4\", \"description\": \"Pre generated bundle of Mozilla certificates\", \"licenses\": [ { \"license\": { \"id\": \"MPL-2.0\" } }, { \"license\": { \"id\": \"MIT\" } } ], \"cpe\": \"cpe:2.3:a:ca-certificates-bundle:ca-certificates-bundle:20220614-r4:*:*:*:*:*:*:*\", \"purl\": \"pkg:apk/alpine/ca-certificates-bundle@20220614-r4?arch=x86_64&upstream=ca-certificates&distro=alpine-3.17.3\", \"externalReferences\": [ { \"url\": \"https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/\", \"type\": \"distribution\" } ], \"properties\": [ { \"name\": \"syft:package:foundBy\", \"value\": \"apkdb-cataloger\" }, { \"name\": \"syft:package:metadataType\", \"value\": \"ApkMetadata\" }, { \"name\": \"syft:package:type\", \"value\": \"apk\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:ca-certificates-bundle:ca_certificates_bundle:20220614-r4:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:ca_certificates_bundle:ca-certificates-bundle:20220614-r4:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:ca_certificates_bundle:ca_certificates_bundle:20220614-r4:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:ca-certificates:ca-certificates-bundle:20220614-r4:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:ca-certificates:ca_certificates_bundle:20220614-r4:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:ca_certificates:ca-certificates-bundle:20220614-r4:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:ca_certificates:ca_certificates_bundle:20220614-r4:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:ca:ca-certificates-bundle:20220614-r4:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:ca:ca_certificates_bundle:20220614-r4:*:*:*:*:*:*:*\" }, { \"name\": \"syft:location:0:layerID\", \"value\": \"sha256:f1417ff83b319fbdae6dd9cd6d8c9c88002dcd75ecf6ec201c8c6894681cf2b5\" }, { \"name\": \"syft:location:0:path\", \"value\": \"/lib/apk/db/installed\" }, { \"name\": \"syft:metadata:gitCommitOfApkPort\", \"value\": \"e1839fd45a096c9e21ac24f8a61991d357d11628\" }, { \"name\": \"syft:metadata:installedSize\", \"value\": \"237568\" }, { \"name\": \"syft:metadata:originPackage\", \"value\": \"ca-certificates\" }, { \"name\": \"syft:metadata:provides:0\", \"value\": \"ca-certificates-cacert=20220614-r4\" }, { \"name\": \"syft:metadata:pullChecksum\", \"value\": \"Q14PFUzkDXTGDcHkiuEdFuzb+EvxQ=\" }, { \"name\": \"syft:metadata:size\", \"value\": \"126296\" } ] }, { \"bom-ref\": \"pkg:apk/alpine/libc-utils@0.7.2-r3?arch=x86_64&upstream=libc-dev&distro=alpine-3.17.3&package-id=8126b232e2d3c608\", \"type\": \"library\", \"publisher\": \"Natanael Copa <ncopa@alpinelinux.org>\", \"name\": \"libc-utils\", \"version\": \"0.7.2-r3\", \"description\": \"Meta package to pull in correct libc\", \"licenses\": [ { \"license\": { \"id\": \"BSD-2-Clause\" } }, { \"license\": { \"id\": \"BSD-3-Clause\" } } ], \"cpe\": \"cpe:2.3:a:libc-utils:libc-utils:0.7.2-r3:*:*:*:*:*:*:*\", \"purl\": \"pkg:apk/alpine/libc-utils@0.7.2-r3?arch=x86_64&upstream=libc-dev&distro=alpine-3.17.3\", \"externalReferences\": [ { \"url\": \"https://alpinelinux.org\", \"type\": \"distribution\" } ], \"properties\": [ { \"name\": \"syft:package:foundBy\", \"value\": \"apkdb-cataloger\" }, { \"name\": \"syft:package:metadataType\", \"value\": \"ApkMetadata\" }, { \"name\": \"syft:package:type\", \"value\": \"apk\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:libc-utils:libc_utils:0.7.2-r3:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:libc_utils:libc-utils:0.7.2-r3:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:libc_utils:libc_utils:0.7.2-r3:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:libc:libc-utils:0.7.2-r3:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:libc:libc_utils:0.7.2-r3:*:*:*:*:*:*:*\" }, { \"name\": \"syft:location:0:layerID\", \"value\": \"sha256:f1417ff83b319fbdae6dd9cd6d8c9c88002dcd75ecf6ec201c8c6894681cf2b5\" }, { \"name\": \"syft:location:0:path\", \"value\": \"/lib/apk/db/installed\" }, { \"name\": \"syft:metadata:gitCommitOfApkPort\", \"value\": \"60424133be2e79bbfeff3d58147a22886f817ce2\" }, { \"name\": \"syft:metadata:installedSize\", \"value\": \"4096\" }, { \"name\": \"syft:metadata:originPackage\", \"value\": \"libc-dev\" }, { \"name\": \"syft:metadata:pullChecksum\", \"value\": \"Q19Gg06pBPiiG9UN94ql7qImsHSUQ=\" }, { \"name\": \"syft:metadata:pullDependencies:0\", \"value\": \"musl-utils\" }, { \"name\": \"syft:metadata:size\", \"value\": \"1485\" } ] }, { \"bom-ref\": \"pkg:apk/alpine/libcrypto3@3.0.8-r3?arch=x86_64&upstream=openssl&distro=alpine-3.17.3&package-id=d3084c788891fb28\", \"type\": \"library\", \"publisher\": \"Ariadne Conill <ariadne@dereferenced.org>\", \"name\": \"libcrypto3\", \"version\": \"3.0.8-r3\", \"description\": \"Crypto library from openssl\", \"licenses\": [ { \"license\": { \"id\": \"Apache-2.0\" } } ], \"cpe\": \"cpe:2.3:a:libcrypto3:libcrypto3:3.0.8-r3:*:*:*:*:*:*:*\", \"purl\": \"pkg:apk/alpine/libcrypto3@3.0.8-r3?arch=x86_64&upstream=openssl&distro=alpine-3.17.3\", \"externalReferences\": [ { \"url\": \"https://www.openssl.org/\", \"type\": \"distribution\" } ], \"properties\": [ { \"name\": \"syft:package:foundBy\", \"value\": \"apkdb-cataloger\" }, { \"name\": \"syft:package:metadataType\", \"value\": \"ApkMetadata\" }, { \"name\": \"syft:package:type\", \"value\": \"apk\" }, { \"name\": \"syft:location:0:layerID\", \"value\": \"sha256:f1417ff83b319fbdae6dd9cd6d8c9c88002dcd75ecf6ec201c8c6894681cf2b5\" }, { \"name\": \"syft:location:0:path\", \"value\": \"/lib/apk/db/installed\" }, { \"name\": \"syft:metadata:gitCommitOfApkPort\", \"value\": \"b2ba8be016cab98f44a49ca48f7d514799eff277\" }, { \"name\": \"syft:metadata:installedSize\", \"value\": \"4206592\" }, { \"name\": \"syft:metadata:originPackage\", \"value\": \"openssl\" }, { \"name\": \"syft:metadata:provides:0\", \"value\": \"so:libcrypto.so.3=3\" }, { \"name\": \"syft:metadata:pullChecksum\", \"value\": \"Q1cMUwxuSH1GdRU/3jE0siXde5Vt0=\" }, { \"name\": \"syft:metadata:pullDependencies:0\", \"value\": \"so:libc.musl-x86_64.so.1\" }, { \"name\": \"syft:metadata:size\", \"value\": \"1710299\" } ] }, { \"bom-ref\": \"pkg:apk/alpine/libssl3@3.0.8-r3?arch=x86_64&upstream=openssl&distro=alpine-3.17.3&package-id=2a95f0251fba7a33\", \"type\": \"library\", \"publisher\": \"Ariadne Conill <ariadne@dereferenced.org>\", \"name\": \"libssl3\", \"version\": \"3.0.8-r3\", \"description\": \"SSL shared libraries\", \"licenses\": [ { \"license\": { \"id\": \"Apache-2.0\" } } ], \"cpe\": \"cpe:2.3:a:libssl3:libssl3:3.0.8-r3:*:*:*:*:*:*:*\", \"purl\": \"pkg:apk/alpine/libssl3@3.0.8-r3?arch=x86_64&upstream=openssl&distro=alpine-3.17.3\", \"externalReferences\": [ { \"url\": \"https://www.openssl.org/\", \"type\": \"distribution\" } ], \"properties\": [ { \"name\": \"syft:package:foundBy\", \"value\": \"apkdb-cataloger\" }, { \"name\": \"syft:package:metadataType\", \"value\": \"ApkMetadata\" }, { \"name\": \"syft:package:type\", \"value\": \"apk\" }, { \"name\": \"syft:location:0:layerID\", \"value\": \"sha256:f1417ff83b319fbdae6dd9cd6d8c9c88002dcd75ecf6ec201c8c6894681cf2b5\" }, { \"name\": \"syft:location:0:path\", \"value\": \"/lib/apk/db/installed\" }, { \"name\": \"syft:metadata:gitCommitOfApkPort\", \"value\": \"b2ba8be016cab98f44a49ca48f7d514799eff277\" }, { \"name\": \"syft:metadata:installedSize\", \"value\": \"622592\" }, { \"name\": \"syft:metadata:originPackage\", \"value\": \"openssl\" }, { \"name\": \"syft:metadata:provides:0\", \"value\": \"so:libssl.so.3=3\" }, { \"name\": \"syft:metadata:pullChecksum\", \"value\": \"Q1AABw28u/ULXy0LIj4VbIvBPZFTA=\" }, { \"name\": \"syft:metadata:pullDependencies:0\", \"value\": \"so:libc.musl-x86_64.so.1\" }, { \"name\": \"syft:metadata:pullDependencies:1\", \"value\": \"so:libcrypto.so.3\" }, { \"name\": \"syft:metadata:size\", \"value\": \"246840\" } ] }, { \"bom-ref\": \"pkg:apk/alpine/musl@1.2.3-r4?arch=x86_64&upstream=musl&distro=alpine-3.17.3&package-id=d9700f02cf26e8b8\", \"type\": \"library\", \"publisher\": \"Timo Teräs <timo.teras@iki.fi>\", \"name\": \"musl\", \"version\": \"1.2.3-r4\", \"description\": \"the musl c library (libc) implementation\", \"licenses\": [ { \"license\": { \"id\": \"MIT\" } } ], \"cpe\": \"cpe:2.3:a:musl:musl:1.2.3-r4:*:*:*:*:*:*:*\", \"purl\": \"pkg:apk/alpine/musl@1.2.3-r4?arch=x86_64&upstream=musl&distro=alpine-3.17.3\", \"externalReferences\": [ { \"url\": \"https://musl.libc.org/\", \"type\": \"distribution\" } ], \"properties\": [ { \"name\": \"syft:package:foundBy\", \"value\": \"apkdb-cataloger\" }, { \"name\": \"syft:package:metadataType\", \"value\": \"ApkMetadata\" }, { \"name\": \"syft:package:type\", \"value\": \"apk\" }, { \"name\": \"syft:location:0:layerID\", \"value\": \"sha256:f1417ff83b319fbdae6dd9cd6d8c9c88002dcd75ecf6ec201c8c6894681cf2b5\" }, { \"name\": \"syft:location:0:path\", \"value\": \"/lib/apk/db/installed\" }, { \"name\": \"syft:metadata:gitCommitOfApkPort\", \"value\": \"f93af038c3de7146121c2ea8124ba5ce29b4b058\" }, { \"name\": \"syft:metadata:installedSize\", \"value\": \"634880\" }, { \"name\": \"syft:metadata:originPackage\", \"value\": \"musl\" }, { \"name\": \"syft:metadata:provides:0\", \"value\": \"so:libc.musl-x86_64.so.1=1\" }, { \"name\": \"syft:metadata:pullChecksum\", \"value\": \"Q1Pk7x1woArbB1nzkMPJPq1TECwus=\" }, { \"name\": \"syft:metadata:size\", \"value\": \"388955\" } ] }, { \"bom-ref\": \"pkg:apk/alpine/musl-utils@1.2.3-r4?arch=x86_64&upstream=musl&distro=alpine-3.17.3&package-id=f71ecf5267e6c37b\", \"type\": \"library\", \"publisher\": \"Timo Teräs <timo.teras@iki.fi>\", \"name\": \"musl-utils\", \"version\": \"1.2.3-r4\", \"description\": \"the musl c library (libc) implementation\", \"licenses\": [ { \"license\": { \"id\": \"MIT\" } }, { \"license\": { \"id\": \"BSD-2-Clause\" } }, { \"license\": { \"id\": \"GPL-2.0-or-later\" } } ], \"cpe\": \"cpe:2.3:a:musl-utils:musl-utils:1.2.3-r4:*:*:*:*:*:*:*\", \"purl\": \"pkg:apk/alpine/musl-utils@1.2.3-r4?arch=x86_64&upstream=musl&distro=alpine-3.17.3\", \"externalReferences\": [ { \"url\": \"https://musl.libc.org/\", \"type\": \"distribution\" } ], \"properties\": [ { \"name\": \"syft:package:foundBy\", \"value\": \"apkdb-cataloger\" }, { \"name\": \"syft:package:metadataType\", \"value\": \"ApkMetadata\" }, { \"name\": \"syft:package:type\", \"value\": \"apk\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:musl-utils:musl_utils:1.2.3-r4:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:musl_utils:musl-utils:1.2.3-r4:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:musl_utils:musl_utils:1.2.3-r4:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:musl:musl-utils:1.2.3-r4:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:musl:musl_utils:1.2.3-r4:*:*:*:*:*:*:*\" }, { \"name\": \"syft:location:0:layerID\", \"value\": \"sha256:f1417ff83b319fbdae6dd9cd6d8c9c88002dcd75ecf6ec201c8c6894681cf2b5\" }, { \"name\": \"syft:location:0:path\", \"value\": \"/lib/apk/db/installed\" }, { \"name\": \"syft:metadata:gitCommitOfApkPort\", \"value\": \"f93af038c3de7146121c2ea8124ba5ce29b4b058\" }, { \"name\": \"syft:metadata:installedSize\", \"value\": \"135168\" }, { \"name\": \"syft:metadata:originPackage\", \"value\": \"musl\" }, { \"name\": \"syft:metadata:provides:0\", \"value\": \"cmd:getconf=1.2.3-r4\" }, { \"name\": \"syft:metadata:provides:1\", \"value\": \"cmd:getent=1.2.3-r4\" }, { \"name\": \"syft:metadata:provides:2\", \"value\": \"cmd:iconv=1.2.3-r4\" }, { \"name\": \"syft:metadata:provides:3\", \"value\": \"cmd:ldconfig=1.2.3-r4\" }, { \"name\": \"syft:metadata:provides:4\", \"value\": \"cmd:ldd=1.2.3-r4\" }, { \"name\": \"syft:metadata:pullChecksum\", \"value\": \"Q1ZWJL4eySx8nPSjF1FAJgQyvuNs4=\" }, { \"name\": \"syft:metadata:pullDependencies:0\", \"value\": \"scanelf\" }, { \"name\": \"syft:metadata:pullDependencies:1\", \"value\": \"so:libc.musl-x86_64.so.1\" }, { \"name\": \"syft:metadata:size\", \"value\": \"36697\" } ] }, { \"bom-ref\": \"pkg:apk/alpine/scanelf@1.3.5-r1?arch=x86_64&upstream=pax-utils&distro=alpine-3.17.3&package-id=e903138d19e85b80\", \"type\": \"library\", \"publisher\": \"Natanael Copa <ncopa@alpinelinux.org>\", \"name\": \"scanelf\", \"version\": \"1.3.5-r1\", \"description\": \"Scan ELF binaries for stuff\", \"licenses\": [ { \"license\": { \"id\": \"GPL-2.0-only\" } } ], \"cpe\": \"cpe:2.3:a:scanelf:scanelf:1.3.5-r1:*:*:*:*:*:*:*\", \"purl\": \"pkg:apk/alpine/scanelf@1.3.5-r1?arch=x86_64&upstream=pax-utils&distro=alpine-3.17.3\", \"externalReferences\": [ { \"url\": \"https://wiki.gentoo.org/wiki/Hardened/PaX_Utilities\", \"type\": \"distribution\" } ], \"properties\": [ { \"name\": \"syft:package:foundBy\", \"value\": \"apkdb-cataloger\" }, { \"name\": \"syft:package:metadataType\", \"value\": \"ApkMetadata\" }, { \"name\": \"syft:package:type\", \"value\": \"apk\" }, { \"name\": \"syft:location:0:layerID\", \"value\": \"sha256:f1417ff83b319fbdae6dd9cd6d8c9c88002dcd75ecf6ec201c8c6894681cf2b5\" }, { \"name\": \"syft:location:0:path\", \"value\": \"/lib/apk/db/installed\" }, { \"name\": \"syft:metadata:gitCommitOfApkPort\", \"value\": \"e52243dbb02069f10d48440ccc5fd41fa5fc2236\" }, { \"name\": \"syft:metadata:installedSize\", \"value\": \"98304\" }, { \"name\": \"syft:metadata:originPackage\", \"value\": \"pax-utils\" }, { \"name\": \"syft:metadata:provides:0\", \"value\": \"cmd:scanelf=1.3.5-r1\" }, { \"name\": \"syft:metadata:pullChecksum\", \"value\": \"Q11dxYFsHvBFAzzHGDo5gOTDNJDyQ=\" }, { \"name\": \"syft:metadata:pullDependencies:0\", \"value\": \"so:libc.musl-x86_64.so.1\" }, { \"name\": \"syft:metadata:size\", \"value\": \"37687\" } ] }, { \"bom-ref\": \"pkg:apk/alpine/ssl_client@1.35.0-r29?arch=x86_64&upstream=busybox&distro=alpine-3.17.3&package-id=b15247aafcd4a647\", \"type\": \"library\", \"publisher\": \"Sören Tempel <soeren+alpine@soeren-tempel.net>\", \"name\": \"ssl_client\", \"version\": \"1.35.0-r29\", \"description\": \"EXternal ssl_client for busybox wget\", \"licenses\": [ { \"license\": { \"id\": \"GPL-2.0-only\" } } ], \"cpe\": \"cpe:2.3:a:ssl-client:ssl-client:1.35.0-r29:*:*:*:*:*:*:*\", \"purl\": \"pkg:apk/alpine/ssl_client@1.35.0-r29?arch=x86_64&upstream=busybox&distro=alpine-3.17.3\", \"externalReferences\": [ { \"url\": \"https://busybox.net/\", \"type\": \"distribution\" } ], \"properties\": [ { \"name\": \"syft:package:foundBy\", \"value\": \"apkdb-cataloger\" }, { \"name\": \"syft:package:metadataType\", \"value\": \"ApkMetadata\" }, { \"name\": \"syft:package:type\", \"value\": \"apk\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:ssl-client:ssl_client:1.35.0-r29:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:ssl_client:ssl-client:1.35.0-r29:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:ssl_client:ssl_client:1.35.0-r29:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:ssl:ssl-client:1.35.0-r29:*:*:*:*:*:*:*\" }, { \"name\": \"syft:cpe23\", \"value\": \"cpe:2.3:a:ssl:ssl_client:1.35.0-r29:*:*:*:*:*:*:*\" }, { \"name\": \"syft:location:0:layerID\", \"value\": \"sha256:f1417ff83b319fbdae6dd9cd6d8c9c88002dcd75ecf6ec201c8c6894681cf2b5\" }, { \"name\": \"syft:location:0:path\", \"value\": \"/lib/apk/db/installed\" }, { \"name\": \"syft:metadata:gitCommitOfApkPort\", \"value\": \"1dbf7a793afae640ea643a055b6dd4f430ac116b\" }, { \"name\": \"syft:metadata:installedSize\", \"value\": \"28672\" }, { \"name\": \"syft:metadata:originPackage\", \"value\": \"busybox\" }, { \"name\": \"syft:metadata:provides:0\", \"value\": \"cmd:ssl_client=1.35.0-r29\" }, { \"name\": \"syft:metadata:pullChecksum\", \"value\": \"Q1QuqZjeP6XG85I29tOiCWofL8Cj0=\" }, { \"name\": \"syft:metadata:pullDependencies:0\", \"value\": \"so:libc.musl-x86_64.so.1\" }, { \"name\": \"syft:metadata:pullDependencies:1\", \"value\": \"so:libcrypto.so.3\" }, { \"name\": \"syft:metadata:pullDependencies:2\", \"value\": \"so:libssl.so.3\" }, { \"name\": \"syft:metadata:size\", \"value\": \"4929\" } ] }, { \"bom-ref\": \"pkg:apk/alpine/zlib@1.2.13-r0?arch=x86_64&upstream=zlib&distro=alpine-3.17.3&package-id=94014313cfcd2b71\", \"type\": \"library\", \"publisher\": \"Natanael Copa <ncopa@alpinelinux.org>\", \"name\": \"zlib\", \"version\": \"1.2.13-r0\", \"description\": \"A compression/decompression Library\", \"licenses\": [ { \"license\": { \"id\": \"Zlib\" } } ], \"cpe\": \"cpe:2.3:a:zlib:zlib:1.2.13-r0:*:*:*:*:*:*:*\", \"purl\": \"pkg:apk/alpine/zlib@1.2.13-r0?arch=x86_64&upstream=zlib&distro=alpine-3.17.3\", \"externalReferences\": [ { \"url\": \"https://zlib.net/\", \"type\": \"distribution\" } ], \"properties\": [ { \"name\": \"syft:package:foundBy\", \"value\": \"apkdb-cataloger\" }, { \"name\": \"syft:package:metadataType\", \"value\": \"ApkMetadata\" }, { \"name\": \"syft:package:type\", \"value\": \"apk\" }, { \"name\": \"syft:location:0:layerID\", \"value\": \"sha256:f1417ff83b319fbdae6dd9cd6d8c9c88002dcd75ecf6ec201c8c6894681cf2b5\" }, { \"name\": \"syft:location:0:path\", \"value\": \"/lib/apk/db/installed\" }, { \"name\": \"syft:metadata:gitCommitOfApkPort\", \"value\": \"bb37266b06a72d21d1fd850ef4b86665cf9ef70f\" }, { \"name\": \"syft:metadata:installedSize\", \"value\": \"110592\" }, { \"name\": \"syft:metadata:originPackage\", \"value\": \"zlib\" }, { \"name\": \"syft:metadata:provides:0\", \"value\": \"so:libz.so.1=1.2.13\" }, { \"name\": \"syft:metadata:pullChecksum\", \"value\": \"Q1rjnXT01l1PAxXheUxe4Oldl5rFk=\" }, { \"name\": \"syft:metadata:pullDependencies:0\", \"value\": \"so:libc.musl-x86_64.so.1\" }, { \"name\": \"syft:metadata:size\", \"value\": \"54258\" } ] }, { \"type\": \"operating-system\", \"name\": \"alpine\", \"version\": \"3.17.3\", \"description\": \"Alpine Linux v3.17\", \"swid\": { \"tagId\": \"alpine\", \"name\": \"alpine\", \"version\": \"3.17.3\" }, \"externalReferences\": [ { \"url\": \"https://gitlab.alpinelinux.org/alpine/aports/-/issues\", \"type\": \"issue-tracker\" }, { \"url\": \"https://alpinelinux.org/\", \"type\": \"website\" } ], \"properties\": [ { \"name\": \"syft:distro:id\", \"value\": \"alpine\" }, { \"name\": \"syft:distro:prettyName\", \"value\": \"Alpine Linux v3.17\" }, { \"name\": \"syft:distro:versionID\", \"value\": \"3.17.3\" } ] } ] }";

    public static final CDX14JSONDeserializer DESERIALIZER = new CDX14JSONDeserializer();

    @Test
    @ValueSource(strings = { TEST_SMALL_CDX_JSON })
    public void build_SBOM_from_small_cdx_json_test() throws JsonProcessingException {
        SBOM sbom = this.DESERIALIZER.readFromString(TEST_SMALL_CDX_JSON);
        assertNotNull(sbom);
        assertEquals("1", sbom.getVersion());
        assertEquals("1.4", sbom.getSpecVersion());
        assertEquals(17, sbom.getComponents().size()); // TODO ensure no duplicates added?
        assertEquals("container", sbom.getRootComponent().getType());
    }
}
